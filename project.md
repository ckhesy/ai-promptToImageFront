

---

# 产品需求文档（PRD）  
## 产品名称：AI 消息与媒体平台

---

## 一、产品目标

为用户提供一个基于 AI 的消息与媒体生成平台，支持用户注册、登录、生成多媒体内容（图片、文字、视频），并可便捷地查询和管理历史生成内容。

---

## 二、核心功能

### 1. 用户注册与登录

#### 1.1 用户注册
- **前端需求**：
  - 提供注册页面，用户需填写用户名、邮箱、密码。
  - 表单校验：邮箱格式、必填项、密码长度等。
  - 注册成功后提示，并可直接跳转到登录页或自动登录。
- **后端需求**：
  - 提供注册接口（已实现：`POST /api/v1/users/reg`）。
  - 校验邮箱唯一性、用户名唯一性，密码加密存储。
  - 返回用户基本信息（不返回密码）。

#### 1.2 用户登录
- **前端需求**：
  - 提供登录页面，用户输入邮箱/用户名和密码。
  - 登录成功后进入主页面，失败时提示错误信息。
  - 支持登录态保持（如 localStorage/token）。
- **后端需求**：
  - 新增登录接口（需补充，建议：`POST /api/v1/users/login`）。
    - 请求参数：邮箱/用户名、密码。
    - 返回：用户信息、token（JWT 或 session）。
  - 校验密码，返回登录态凭证。

---

### 2. 消息与媒体生成

#### 2.1 生成消息和媒体
- **前端需求**：
  - 提供生成页面，用户输入 prompt，选择媒体类型（图片、视频、文本）。
  - 支持选择当前登录用户（或自动带入）。
  - 提交后展示生成结果（ID、内容、类型、时间等）。
- **后端需求**：
  - 提供生成接口（已实现：`POST /api/v1/messages/generate`）。
  - 支持根据 type 生成不同类型的媒体内容。
  - 返回生成的消息及媒体信息。

---

### 3. 历史消息与媒体查询

#### 3.1 查询用户历史生成内容
- **前端需求**：
  - 提供历史消息与媒体页面，展示当前用户所有生成的内容。
  - 支持按媒体类型筛选（图片、视频、文本）。
  - 支持分页浏览。
  - 每条内容可查看详情（如媒体预览）。
- **后端需求**：
  - 提供按用户 ID 查询接口（已实现：`GET /api/v1/messages/by_user/{user_id}`）。
  - 支持 media_type、skip、limit 参数筛选和分页。
  - 返回该用户的所有消息与媒体内容。

#### 3.2 查询单条消息详情
- **前端需求**：
  - 支持点击历史记录查看详情。
  - 若为图片/视频，支持媒体预览。
- **后端需求**：
  - 提供按消息 ID 查询接口（已实现：`GET /api/v1/messages/{message_id}`）。
  - 提供获取媒体接口（已实现：`GET /api/v1/messages/{message_id}/media`）。

---

## 三、页面与交互流程

### 1. 登录/注册页
- 用户可选择注册新账号或登录已有账号。
- 登录后进入主页面。

### 2. 生成消息与媒体页
- 输入 prompt，选择媒体类型，点击生成。
- 展示生成结果。

### 3. 历史消息与媒体页
- 展示当前用户所有历史生成内容。
- 支持类型筛选、分页。
- 支持点击查看详情与媒体预览。

---

## 四、接口补充建议

- 新增登录接口（`POST /api/v1/users/login`），返回 token。
- 新增 token 校验机制，保护生成和查询接口（需登录后才能操作）。
- 用户信息接口可补充头像、昵称等字段（可选）。

---

## 五、权限与安全

- 用户注册、登录、生成、查询等操作需鉴权。
- 用户只能查询和管理自己的消息与媒体内容。
- 密码加密存储，token 安全传输。

---

## 六、后续可扩展方向

- 支持消息/媒体的删除、编辑。
- 支持多用户协作、内容分享。
- 支持更丰富的媒体类型和生成参数。

---

如需详细页面原型或接口字段说明，可进一步补充。  
如需后端接口设计建议或前端页面结构建议，也可随时提出！